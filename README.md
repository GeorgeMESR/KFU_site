# KFU_site
Подмена года в pdf. Работает только под линукс- нужны программы LibreOffice, qpdf и inkscape (год правится через файл svg). 

1. Разархивируем скритпты, сохраняя струкутру папок (папка tmp с содержимым нужна для работы).
2. В папку step4 PDF файлы которые нужно обработать.
3. Запускаем скрипт Change2021.py
4. Программа разбивает PDF на страницы. Первую, предпоследнюю и последнюю страницы конвертирует в SVG. В файлах SVG ищет 2022 и меняет его на 2021. Если же файл был упакован или страницы были заменены сканами, то программа ничего не сделает. Потом объединяет новые страницы и старые в один файл. Для того что бы год изменился и на файле с ФОС, он должен лежать отдельно от файла с РПД.

Работа через базу данных.
1 Шаг. Ставим Python, модули к нему Pillow, pdf2image, imageio, csv. Распаковываем куда нибудь папку со скриптами, сохраняя струкутру папок (папка tmp с содержимым нужна для работы). Можно на каждое направление-профиль свою папку. 

2 Шаг. Получение базы данных.
Построить базу данных с информацией где на сайте лежат РПД, возможно только взяв страницу «Образовательные программы» с Web системы «студент» и конвертировав ее в csv файл. 
Для этого нужен браузер FireFox и расширение к нему «Table to csv».
А. Открываем нужную образовательную программу
Б. Нажимаем на основной таблице правой кнопкой и выбираем «This frame»→ «Show only this frame». Из странички должна исчезнуть верхняя панель

B. Запускаем скрипт «Table to csv». Все таблицы обведутся красным.

Г. На главной таблице нажимаем правой кнопкой «Table to csv» → «Export to html» и сохраняем файл в ранее распакованную директорию (папку) как plan.csv.

3 Шаг. Не закрываем страницу «студент». Прописываем год, направление, сокращенное и полное название профиля, квалификацию  в скрипте «GetAllRPDFOS.py». Запускаем скрипт . Скрипт начинает работать и в указанную директорию будет сохранятся список авторов (нужен будет для формирования листа учета кадров). А в поддиректорию «step3» будут сохранятся РПД (в PDF и html-doc) и ФОС (только в PDF). Названия файлов менять нельзя они нужны для последующих шагов. Работает все очень медленно, так как сайт такой. 

4 Шаг. Ставим печати на неподписанные РПД. Работает только под линукс- нужны программы qpdf и LibreOffice.  Прописываем Прописываем год, направление, сокращенное и полное название профиля, квалификацию в скрипте «MakeRPDwithSignature.py». Запускаем скрипт . Скрипт начинает работать и в поддиректорию «step4» будут сохранены РПД+ФОС с подписями (какая подпись зависит от указаного года). 

5 Шаг. «Создаем» РПД 2021 года. Работает только под линукс- нужны программы LibreOffice, qpdf и inkscape (год правится через файл svg). Прописываем год, направление, сокращенное и полное название профиля, квалификацию в скрипте «Make2021.py». Запускаем скрипт. Скрипт начинает работать переформатирую РПД и ФОС из поддиректории «step3» в поддиректорию «step5» РПД+ФОС с подписями.
